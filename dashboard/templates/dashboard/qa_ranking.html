{% extends "dashboard/base.html" %}

{% block content %}
    <h1>Ranking de Evaluaciones QA</h1>
    
    <!-- Mostrar filtros aplicados -->
    <p>
        {% if selected_agent %} Agente: {{ selected_agent }} {% endif %}
        {% if selected_team %} | Equipo: {{ selected_team }} {% endif %}
        {% if week_start %} | Inicio: {{ week_start }} {% endif %}
        {% if week_end %} | Fin: {{ week_end }} {% endif %}
    </p>
    
    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Agente</th>
                <th>Promedio Total Final Score (QA)</th>
            </tr>
        </thead>
        <tbody>
            {% for item in ranking %}
            <tr>
                <td>{{ item.agent__agent_name }}</td>
                <td>{{ item.avg_qa|floatformat:2 }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="2">No se encontraron evaluaciones con los filtros aplicados.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <br>
    <a href="{% url 'qa_report' %}?agent={{ selected_agent|default:'' }}&team={{ selected_team|default:'' }}&week_start={{ week_start|default:'' }}&week_end={{ week_end|default:'' }}"
       style="display: inline-block; background: #333; color: #fff; padding: 8px 12px; text-decoration: none; border-radius: 4px;">
       Volver al Reporte QA
    </a>
{% endblock %}
